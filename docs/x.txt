# ã‚·ã‚¹ãƒ†ãƒ æ”¹å–„ãƒãƒ¼ãƒˆ (Kaizen Note)

ç”Ÿæˆæ—¥æ™‚: 2025-10-01
åˆ†æå¯¾è±¡: TradeEngine2/data_controller

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### åŸºæœ¬çµ±è¨ˆ
- **ç·Goãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 66ãƒ•ã‚¡ã‚¤ãƒ«
- **ç·è¡Œæ•°**: ç´„16,867è¡Œ
- **ä¸»è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: cmd, internal, pkg, config, docs, examples

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- **è¨€èª**: Go 1.25.1
- **GUIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Fyne
- **ãƒ‡ãƒ¼ã‚¿å½¢å¼**: Apache Arrow/Parquet
- **å¯¾è±¡å–å¼•æ‰€**: Bitfinex (å°†æ¥çš„ã«Binance, Coinbase, Krakenå¯¾å¿œäºˆå®š)

---

## 2. æœªä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒªãƒ³ãƒœãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« (Limbo Files)

### 2.1 å®Œå…¨ã«ç©ºã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä½œæˆã•ã‚Œã¦ã„ã‚‹ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒä¸€åˆ‡å­˜åœ¨ã—ãªã„ï¼š

1. **`internal/bitfinex/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
2. **`internal/book/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
3. **`internal/metrics/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
4. **`internal/models/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

ã“ã‚Œã‚‰ã¯ã©ã“ã‹ã‚‰ã‚‚importã•ã‚Œã¦ã„ãªã„ã€‚

### 2.2 æœªä½¿ç”¨ã®ãƒ‘ãƒãƒ«å®Ÿè£… (é‡è¤‡)

#### `internal/ui/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…¨ä½“ãŒæœªä½¿ç”¨
- `internal/ui/panels/files_panel.go` (5.5K)
- `internal/ui/panels/viewer_panel.go` (5.6K)
- `internal/ui/components/date_picker.go`

**ç¾çŠ¶**:
- `internal/ui/panels/` ã¯ `internal/state` ã‚’import
- `internal/gui/panels/` ã¯ `internal/gui/state` ã‚’import
- **å®Ÿéš›ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã®ã¯ `internal/gui/panels/` ã®ã¿**
- `internal/gui/app/app.go` ãŒ `internal/gui/panels` ã‚’import

**å•é¡Œç‚¹**:
- åŒã˜æ©Ÿèƒ½ã®å®Ÿè£…ãŒ2ç®‡æ‰€ã«å­˜åœ¨
- `internal/ui/` ã¯å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ€ã‚ã‚Œã‚‹
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚‚ç•°ãªã‚‹ (guiç‰ˆãŒå¤§ãã„: 13K vs 5.5K)

### 2.3 æœªä½¿ç”¨ã®çŠ¶æ…‹ç®¡ç† (é‡è¤‡)

#### `internal/state/` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæœªä½¿ç”¨
- `internal/state/app_state.go`
- `internal/ui/` ã‹ã‚‰ã®ã¿å‚ç…§ã•ã‚Œã¦ã„ã‚‹
- å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ `internal/gui/state/` ã‚’ä½¿ç”¨

**ä½¿ç”¨çŠ¶æ³**:
```
internal/gui/state/ â† ä½¿ç”¨ä¸­ (gui/app, gui/panels, gui/controllers ã‹ã‚‰å‚ç…§)
internal/state/     â† æœªä½¿ç”¨ (ui/panels ã‹ã‚‰ã®ã¿å‚ç…§ã€uiè‡ªä½“ãŒæœªä½¿ç”¨)
```

### 2.4 æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® REST Data Panel

#### `internal/gui/rest_data_panel.go` (766è¡Œ)
- é–¢æ•°æ•°: 19å€‹
- **NewRestDataPanel() ãŒä¸€åº¦ã‚‚å‘¼ã°ã‚Œã¦ã„ãªã„**
- V2ç‰ˆ (`rest_data_panel_v2.go`) ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹

**ä½¿ç”¨çŠ¶æ³**:
```
rest_data_panel.go    â† æœªä½¿ç”¨ (å®šç¾©ã®ã¿ã€å‘¼ã³å‡ºã—ãªã—)
rest_data_panel_v2.go â† ä½¿ç”¨ä¸­ (rest_api_panel.go ã‹ã‚‰å‘¼ã³å‡ºã—)
```

### 2.5 é‡è¤‡ã™ã‚‹ã‚¹ã‚¿ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«

ä»¥ä¸‹ã®2ãƒ•ã‚¡ã‚¤ãƒ«ã¯åŒã˜ç›®çš„ (GUIãƒ“ãƒ«ãƒ‰ã‚¿ã‚°ãªã—æ™‚ã®ä»£æ›¿å®Ÿè£…):
- `cmd/data-controller/gui_stub.go`
- `cmd/data-controller/stub_gui.go`

ä¸¡æ–¹ã¨ã‚‚ `//go:build !gui` ã‚¿ã‚°ã‚’æŒã¤ã€‚

### 2.6 ãƒ†ã‚¹ãƒˆãƒ»ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«

#### `examples/test_config_system.go`
- å‹•ä½œç¢ºèªç”¨ã®ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
- æœ¬ç•ªã§ã¯æœªä½¿ç”¨
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»å‚è€ƒå®Ÿè£…ã¨ã—ã¦ä¾¡å€¤ã‚ã‚Š

---

## 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®é‡è¤‡ã¨å½¹å‰²ã®æ›–æ˜§ã•

### 3.1 Bitfinexè¨­å®šã®é‡è¤‡

**é‡è¤‡ã—ã¦ã„ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**:
```
config/bitfinex_config.yml          â† ãƒ«ãƒ¼ãƒˆç›´ä¸‹
config/exchanges/bitfinex_config.yml â† exchanges ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
```

ã©ã¡ã‚‰ãŒæ­£å¼ãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‹ä¸æ˜ç¢ºã€‚

### 3.2 çŠ¶æ…‹ãƒ•ã‚¡ã‚¤ãƒ«ã®é‡è¤‡

**é‡è¤‡ã—ã¦ã„ã‚‹çŠ¶æ…‹ãƒ•ã‚¡ã‚¤ãƒ«**:
```
config/state.yml       â† ãƒ«ãƒ¼ãƒˆç›´ä¸‹
config/state/state.yml â† state ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
```

ã©ã¡ã‚‰ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ä¸æ˜ç¢ºã€‚

### 3.3 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

ä»¥ä¸‹ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨:
1. `config/config.yml` - ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
2. `config/bitfinex_config.yml` - Bitfinex WebSocket/ãƒãƒ£ãƒãƒ«è¨­å®š
3. `config/exchanges/bitfinex_config.yml` - (é‡è¤‡)
4. `config/schema.json` - è¨­å®šã‚¹ã‚­ãƒ¼ãƒå®šç¾©
5. `config/state.yml` - ãƒ©ãƒ³ã‚¿ã‚¤ãƒ çŠ¶æ…‹
6. `config/state/state.yml` - (é‡è¤‡)

**å•é¡Œç‚¹**:
- å½¹å‰²åˆ†æ‹…ãŒä¸æ˜ç¢º
- ãƒ«ãƒ¼ãƒˆã¨ `exchanges/`, `state/` ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½¿ã„åˆ†ã‘ãŒæ›–æ˜§
- ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå„ªå…ˆã•ã‚Œã‚‹ã‹ä¸æ˜

### 3.4 æœªä½¿ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

```
config/backups/  - ç©º
config/profiles/ - ç©º
config/tmp/      - ç©º
```

---

## 4. è‚¥å¤§åŒ–ã—ãŸã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«

### 4.1 è¶…å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ« (1000è¡Œè¶…)

#### 1. `internal/gui/rest_data_panel_v2.go` - **1,251è¡Œ**
**è²¬å‹™**:
- REST APIãƒ‡ãƒ¼ã‚¿å–å¾—ã®UIç®¡ç†
- Candles/Trades/Tickers ã®3ã¤ã®ãƒ‡ãƒ¼ã‚¿å‹ç®¡ç†
- æ¥ç¶šçŠ¶æ…‹ç®¡ç†
- ãƒ‡ãƒ¼ã‚¿åé›†ãƒ­ã‚¸ãƒƒã‚¯ (CSVæ›¸ãè¾¼ã¿å«ã‚€)
- UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (ãƒœã‚¿ãƒ³ã€ãƒ­ã‚°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°)

**é–¢æ•°æ•°**: 37å€‹

**å•é¡Œç‚¹**:
- UIå±¤ã¨ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ãŒæ··åœ¨
- ãƒ‡ãƒ¼ã‚¿åé›†ãƒ­ã‚¸ãƒƒã‚¯ãŒ1ãƒ•ã‚¡ã‚¤ãƒ«ã«é›†ä¸­
- ãƒ†ã‚¹ãƒˆãŒå›°é›£

**åˆ†å‰²æ¡ˆ**:
1. `rest_data_panel_v2_ui.go` - UI components
2. `rest_data_collector_candles.go` - Candles collection logic
3. `rest_data_collector_trades.go` - Trades collection logic
4. `rest_data_collector_tickers.go` - Tickers collection logic
5. `rest_data_state.go` - State management

### 4.2 å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ« (600-800è¡Œ)

#### 2. `internal/gui/rest_data_panel.go` - **766è¡Œ** (æœªä½¿ç”¨)
- ä¸Šè¨˜V2ã¨åŒæ§˜ã®æ§‹é€ 
- **å‰Šé™¤æ¨å¥¨**

#### 3. `internal/ws/conn.go` - **676è¡Œ**
**è²¬å‹™**:
- WebSocketæ¥ç¶šç®¡ç†
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€å—ä¿¡
- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†
- ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆãƒ»å†æ¥ç¶šãƒ­ã‚¸ãƒƒã‚¯
- æ¥ç¶šãƒ—ãƒ¼ãƒ«ç®¡ç†

**é–¢æ•°æ•°**: 23å€‹

**å•é¡Œç‚¹**:
- æ¥ç¶šç®¡ç†ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ãŒæ··åœ¨
- è¤‡æ•°ã®è²¬å‹™ãŒ1ãƒ•ã‚¡ã‚¤ãƒ«ã«é›†ç´„

**åˆ†å‰²æ¡ˆ**:
1. `ws_connection.go` - å˜ä¸€æ¥ç¶šã®ç®¡ç†
2. `ws_manager.go` - æ¥ç¶šãƒ—ãƒ¼ãƒ«ç®¡ç†
3. `ws_subscription.go` - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†
4. `ws_heartbeat.go` - ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆãƒ»å†æ¥ç¶š

#### 4. `internal/gui/websocket_panel.go` - **647è¡Œ**
**è²¬å‹™**:
- WebSocket UIç®¡ç†
- ãƒãƒ£ãƒãƒ«è¨­å®šãƒ‘ãƒãƒ«ç®¡ç†
- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³åˆ¶é™ç®¡ç†
- æ¥ç¶šã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯

**é–¢æ•°æ•°**: 25å€‹

**åˆ†å‰²æ¡ˆ**:
1. `websocket_panel_ui.go` - UI components
2. `websocket_panel_subscription.go` - Subscription logic

#### 5. `internal/gui/app/app.go` - **607è¡Œ**
**è²¬å‹™**:
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä½œæˆ
- WebSocketæ¥ç¶šãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç®¡ç†

**é–¢æ•°æ•°**: ä¸æ˜

**å•é¡Œç‚¹**:
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦å¤šæ©Ÿèƒ½

### 4.3 ä¸­è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ« (400-600è¡Œ)

#### 6. `internal/sink/arrow/reader.go` - **588è¡Œ**
- Arrow/Parquet ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
- è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿å‹å¯¾å¿œ

#### 7. `internal/gui/channel_books.go` - **520è¡Œ**
- Order Book ãƒãƒ£ãƒãƒ«UI
- è¨­å®šç®¡ç†ãƒ»æ°¸ç¶šåŒ–

#### 8. `internal/gui/panels/files_panel.go` - **480è¡Œ**
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶UI
- ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ

#### 9. `internal/sink/arrow/writer.go` - **457è¡Œ**
- Arrow/Parquet ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿
- ã‚»ã‚°ãƒ¡ãƒ³ãƒˆç®¡ç†

#### 10. `internal/ws/router.go` - **456è¡Œ**
- WebSocketãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- Ticker/Trades/Books ã®ãƒ‘ãƒ¼ã‚¹

#### 11. `internal/gui/channel_candles.go` - **447è¡Œ**
- Candles ãƒãƒ£ãƒãƒ«UI

#### 12. `internal/services/file_scanner.go` - **440è¡Œ**
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³ãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ

#### 13. `internal/gui/channel_ticker.go` - **430è¡Œ**
- Ticker ãƒãƒ£ãƒãƒ«UI

#### 14. `cmd/data-controller/gui.go` - **424è¡Œ**
- GUIåˆæœŸåŒ–ãƒ­ã‚¸ãƒƒã‚¯

#### 15. `internal/gui/controllers/file_controller.go` - **401è¡Œ**
- ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©

#### 16. `internal/gui/channel_trades.go` - **401è¡Œ**
- Trades ãƒãƒ£ãƒãƒ«UI

---

## 5. ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ

### 5.1 ãƒãƒ£ãƒãƒ«ãƒ‘ãƒãƒ«ã®å†—é•·æ€§

ä»¥ä¸‹ã®4ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã»ã¼åŒã˜æ§‹é€ :
1. `channel_ticker.go` (430è¡Œ)
2. `channel_trades.go` (401è¡Œ)
3. `channel_candles.go` (447è¡Œ)
4. `channel_books.go` (520è¡Œ)

**å…±é€šãƒ‘ã‚¿ãƒ¼ãƒ³**:
- `NewXXXChannelPanel()` - ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
- `Build()` - UIæ§‹ç¯‰
- `loadAvailableSymbols()` - ã‚·ãƒ³ãƒœãƒ«èª­ã¿è¾¼ã¿
- `filterSymbols()` - æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿
- `GetSubscriptions()` - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å–å¾—
- `persistState()` / `loadState()` - çŠ¶æ…‹æ°¸ç¶šåŒ–

**æ”¹å–„æ¡ˆ**:
- å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ `ChannelPanel` ã‚’å®šç¾©
- åŸºåº•æ§‹é€ ä½“ `BaseChannelPanel` ã‚’å®Ÿè£…
- å„ãƒãƒ£ãƒãƒ«å›ºæœ‰ã®éƒ¨åˆ†ã®ã¿ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰
- **å‰Šæ¸›åŠ¹æœ**: ç´„1,800è¡Œ â†’ 600-800è¡Œ

### 5.2 REST ãƒ‡ãƒ¼ã‚¿ãƒ‘ãƒãƒ«ã®å†—é•·æ€§

ä»¥ä¸‹ã®3ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã»ã¼åŒã˜æ§‹é€ :
1. `rest_channel_candles.go`
2. `rest_channel_trades.go`
3. `rest_channel_tickers.go`

**æ”¹å–„æ¡ˆ**:
- `BaseRestChannelPanel` æ§‹é€ ä½“ã‚’ä½œæˆ
- å…±é€šãƒ­ã‚¸ãƒƒã‚¯ã‚’é›†ç´„

---

## 6. æ§‹æˆä¸Šã®å•é¡Œç‚¹ã¾ã¨ã‚

### 6.1 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®å•é¡Œ

#### å•é¡Œ1: é‡è¤‡ã—ãŸå®Ÿè£…ãŒè¤‡æ•°å­˜åœ¨
```
internal/
  â”œâ”€â”€ gui/
  â”‚   â”œâ”€â”€ panels/       â† ä½¿ç”¨ä¸­
  â”‚   â””â”€â”€ state/        â† ä½¿ç”¨ä¸­
  â””â”€â”€ ui/               â† æœªä½¿ç”¨ (å…¨ä½“)
      â”œâ”€â”€ panels/       â† æœªä½¿ç”¨
      â”œâ”€â”€ components/   â† æœªä½¿ç”¨
      â””â”€â”€ state/        â† ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„
```

#### å•é¡Œ2: ç©ºã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒæ®‹å­˜
```
internal/
  â”œâ”€â”€ bitfinex/  â† ç©º
  â”œâ”€â”€ book/      â† ç©º
  â”œâ”€â”€ metrics/   â† ç©º
  â””â”€â”€ models/    â† ç©º
```

### 6.2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å•é¡Œ

#### å•é¡Œ1: é‡è¤‡ã™ã‚‹è¨­å®š
```
config/
  â”œâ”€â”€ bitfinex_config.yml
  â”œâ”€â”€ state.yml
  â”œâ”€â”€ exchanges/
  â”‚   â””â”€â”€ bitfinex_config.yml  â† é‡è¤‡
  â””â”€â”€ state/
      â””â”€â”€ state.yml             â† é‡è¤‡
```

#### å•é¡Œ2: ç©ºã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
```
config/
  â”œâ”€â”€ backups/   â† ç©º
  â”œâ”€â”€ profiles/  â† ç©º
  â””â”€â”€ tmp/       â† ç©º
```

### 6.3 ã‚³ãƒ¼ãƒ‰ã®å•é¡Œ

#### å•é¡Œ1: æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒæ®‹å­˜
- `rest_data_panel.go` (æœªä½¿ç”¨) ã¨ `rest_data_panel_v2.go` (ä½¿ç”¨ä¸­)

#### å•é¡Œ2: é‡è¤‡ã™ã‚‹ã‚¹ã‚¿ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«
- `gui_stub.go` ã¨ `stub_gui.go` (ä¸¡æ–¹ã¨ã‚‚åŒã˜ç›®çš„)

#### å•é¡Œ3: éåº¦ã«å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«
- 1,000è¡Œè¶…ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ1ã¤
- 600-800è¡Œã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ3ã¤
- 400-600è¡Œã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ11å€‹

---

## 7. æ”¹å–„ææ¡ˆ

### 7.1 å³åº§ã«å‰Šé™¤å¯èƒ½ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

#### å‰Šé™¤æ¨å¥¨ (é«˜å„ªå…ˆåº¦)
1. **`internal/ui/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…¨ä½“** - å®Œå…¨ã«æœªä½¿ç”¨
2. **`internal/state/app_state.go`** - æœªä½¿ç”¨
3. **`internal/bitfinex/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
4. **`internal/book/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
5. **`internal/metrics/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
6. **`internal/models/`** - ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
7. **`internal/gui/rest_data_panel.go`** - æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³
8. **`cmd/data-controller/gui_stub.go` ã¾ãŸã¯ `stub_gui.go`** - é‡è¤‡ã€ã©ã¡ã‚‰ã‹ä¸€æ–¹
9. **`config/backups/`** - ç©º
10. **`config/profiles/`** - ç©º
11. **`config/tmp/`** - ç©º (ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ãªã‚‰.gitignoreæ¨å¥¨)

**å‰Šæ¸›åŠ¹æœ**: ç´„10ãƒ•ã‚¡ã‚¤ãƒ«ã€ç´„1,500è¡Œ

### 7.2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´ç†

#### ææ¡ˆ1: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®æ˜ç¢ºåŒ–

**ç¾çŠ¶**:
```
config/
  â”œâ”€â”€ config.yml                    â† ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š
  â”œâ”€â”€ bitfinex_config.yml          â† å–å¼•æ‰€è¨­å®š (é‡è¤‡1)
  â”œâ”€â”€ state.yml                    â† çŠ¶æ…‹ (é‡è¤‡1)
  â”œâ”€â”€ schema.json                  â† ã‚¹ã‚­ãƒ¼ãƒ
  â”œâ”€â”€ exchanges/
  â”‚   â””â”€â”€ bitfinex_config.yml     â† (é‡è¤‡2)
  â””â”€â”€ state/
      â””â”€â”€ state.yml                â† (é‡è¤‡2)
```

**æ”¹å–„å¾Œ**:
```
config/
  â”œâ”€â”€ app.yml                      â† ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š (åå‰å¤‰æ›´)
  â”œâ”€â”€ schema.json                  â† ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
  â”œâ”€â”€ exchanges/
  â”‚   â”œâ”€â”€ bitfinex.yml            â† å–å¼•æ‰€åˆ¥è¨­å®š
  â”‚   â”œâ”€â”€ binance.yml             â† (å°†æ¥)
  â”‚   â””â”€â”€ coinbase.yml            â† (å°†æ¥)
  â””â”€â”€ runtime/                     â† æ–°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
      â””â”€â”€ state.yml                â† ãƒ©ãƒ³ã‚¿ã‚¤ãƒ çŠ¶æ…‹
```

**ãƒ«ãƒ¼ãƒ«**:
- **`app.yml`**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®è¨­å®š (storage, logging, monitoring)
- **`exchanges/*.yml`**: å–å¼•æ‰€ã”ã¨ã®è¨­å®š (WebSocket URL, limits, channels)
- **`runtime/state.yml`**: å®Ÿè¡Œæ™‚ã®çŠ¶æ…‹ç®¡ç† (UIçŠ¶æ…‹ã€æ¥ç¶šçŠ¶æ…‹ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥)
- **`schema.json`**: è¨­å®šã®JSONã‚¹ã‚­ãƒ¼ãƒ

### 7.3 ã‚³ãƒ¼ãƒ‰ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ææ¡ˆ

#### Phase 1: é‡è¤‡å‰Šé™¤ (å³å®Ÿè¡Œå¯èƒ½)
1. `internal/ui/` ã‚’å‰Šé™¤
2. `internal/state/` ã‚’å‰Šé™¤
3. ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤
4. `rest_data_panel.go` ã‚’å‰Šé™¤
5. ã‚¹ã‚¿ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±åˆ

**åŠ¹æœ**: ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ç´„20%å‰Šæ¸›

#### Phase 2: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†
1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±åˆãƒ»ç§»å‹•
2. ãƒ­ãƒ¼ãƒ‰é †åºã®æ˜ç¢ºåŒ–
3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

#### Phase 3: ãƒãƒ£ãƒãƒ«ãƒ‘ãƒãƒ«ã®å…±é€šåŒ–

**ç¾çŠ¶** (1,798è¡Œ):
```go
// 4ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§é‡è¤‡å®Ÿè£…
channel_ticker.go  (430è¡Œ)
channel_trades.go  (401è¡Œ)
channel_candles.go (447è¡Œ)
channel_books.go   (520è¡Œ)
```

**æ”¹å–„å¾Œ** (æ¨å®š600-800è¡Œ):
```go
// å…±é€šåŸºç›¤
internal/gui/channels/
  â”œâ”€â”€ base_panel.go          â† å…±é€šå®Ÿè£… (200-300è¡Œ)
  â”œâ”€â”€ ticker_panel.go        â† Tickerå›ºæœ‰ (80-120è¡Œ)
  â”œâ”€â”€ trades_panel.go        â† Tradeså›ºæœ‰ (80-120è¡Œ)
  â”œâ”€â”€ candles_panel.go       â† Candleså›ºæœ‰ (100-150è¡Œ)
  â””â”€â”€ books_panel.go         â† Bookså›ºæœ‰ (140-200è¡Œ)
```

**å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**:
```go
type ChannelPanel interface {
    Build() fyne.CanvasObject
    GetSubscriptions() []ChannelSubscription
    GetSubscriptionCount() int
    LoadState()
    SaveState()
}

type BaseChannelPanel struct {
    logger         *zap.Logger
    configManager  *config.ConfigManager
    exchange       string
    enabled        bool
    selectedSymbols map[string]bool
    // ... å…±é€šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
}
```

**åŠ¹æœ**: ç´„1,000è¡Œå‰Šæ¸›

#### Phase 4: REST ãƒ‡ãƒ¼ã‚¿ãƒ‘ãƒãƒ«ã®åˆ†å‰²

**ç¾çŠ¶**: `rest_data_panel_v2.go` (1,251è¡Œ)

**æ”¹å–„å¾Œ**:
```go
internal/gui/rest/
  â”œâ”€â”€ panel.go               â† UIç®¡ç† (200-300è¡Œ)
  â”œâ”€â”€ state.go               â† çŠ¶æ…‹ç®¡ç† (100-150è¡Œ)
  â””â”€â”€ collectors/
      â”œâ”€â”€ candles.go         â† Candlesåé›† (250-300è¡Œ)
      â”œâ”€â”€ trades.go          â† Tradesåé›† (200-250è¡Œ)
      â””â”€â”€ tickers.go         â† Tickersåé›† (200-250è¡Œ)
```

**åŠ¹æœ**: å¯èª­æ€§ãƒ»ä¿å®ˆæ€§ã®å¤§å¹…å‘ä¸Š

#### Phase 5: WebSocketæ¥ç¶šç®¡ç†ã®åˆ†å‰²

**ç¾çŠ¶**: `ws/conn.go` (676è¡Œ)

**æ”¹å–„å¾Œ**:
```go
internal/ws/
  â”œâ”€â”€ connection.go          â† å˜ä¸€æ¥ç¶š (200-250è¡Œ)
  â”œâ”€â”€ manager.go             â† æ¥ç¶šãƒ—ãƒ¼ãƒ« (150-200è¡Œ)
  â”œâ”€â”€ subscription.go        â† ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ (150-180è¡Œ)
  â””â”€â”€ heartbeat.go           â† ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆ (80-100è¡Œ)
```

**åŠ¹æœ**: å˜ä¸€è²¬ä»»åŸå‰‡ã«æº–æ‹ ã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§å‘ä¸Š

---

## 8. æ¨å¥¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

### 8.1 æ•´ç†å¾Œã®æ§‹é€ 

```
data_controller/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ data-controller/
â”‚       â”œâ”€â”€ main.go
â”‚       â”œâ”€â”€ nogui.go
â”‚       â”œâ”€â”€ fyne_gui.go         # GUIãƒ“ãƒ«ãƒ‰æ™‚
â”‚       â””â”€â”€ stub_gui.go         # éGUIãƒ“ãƒ«ãƒ‰æ™‚ (çµ±åˆå¾Œ)
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ app.yml                 # ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š
â”‚   â”œâ”€â”€ schema.json             # ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â”œâ”€â”€ exchanges/
â”‚   â”‚   â”œâ”€â”€ bitfinex.yml
â”‚   â”‚   â”œâ”€â”€ binance.yml
â”‚   â”‚   â””â”€â”€ coinbase.yml
â”‚   â””â”€â”€ runtime/
â”‚       â””â”€â”€ state.yml           # ãƒ©ãƒ³ã‚¿ã‚¤ãƒ çŠ¶æ…‹
â”‚
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/                 # è¨­å®šç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.go
â”‚   â”‚   â”œâ”€â”€ manager.go
â”‚   â”‚   â”œâ”€â”€ loader.go
â”‚   â”‚   â”œâ”€â”€ normalizer.go
â”‚   â”‚   â””â”€â”€ state.go
â”‚   â”‚
â”‚   â”œâ”€â”€ ws/                     # WebSocket (åˆ†å‰²å¾Œ)
â”‚   â”‚   â”œâ”€â”€ connection.go
â”‚   â”‚   â”œâ”€â”€ manager.go
â”‚   â”‚   â”œâ”€â”€ subscription.go
â”‚   â”‚   â”œâ”€â”€ heartbeat.go
â”‚   â”‚   â””â”€â”€ router.go
â”‚   â”‚
â”‚   â”œâ”€â”€ restapi/                # REST API
â”‚   â”‚   â”œâ”€â”€ client.go
â”‚   â”‚   â”œâ”€â”€ data_client.go
â”‚   â”‚   â”œâ”€â”€ rate_limiter.go
â”‚   â”‚   â””â”€â”€ utils.go
â”‚   â”‚
â”‚   â”œâ”€â”€ sink/                   # ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
â”‚   â”‚   â”œâ”€â”€ arrow/
â”‚   â”‚   â”‚   â”œâ”€â”€ handler.go
â”‚   â”‚   â”‚   â”œâ”€â”€ writer.go
â”‚   â”‚   â”‚   â”œâ”€â”€ reader.go
â”‚   â”‚   â”‚   â”œâ”€â”€ schema.go
â”‚   â”‚   â”‚   â””â”€â”€ channel_writer.go
â”‚   â”‚   â””â”€â”€ wal/                # Write-Ahead Log
â”‚   â”‚
â”‚   â”œâ”€â”€ gui/                    # GUI (çµ±åˆå¾Œ)
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â””â”€â”€ app.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ panels/             # å…±é€šãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ files_panel.go
â”‚   â”‚   â”‚   â””â”€â”€ viewer_panel.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ channels/           # WebSocketãƒãƒ£ãƒãƒ« (å…±é€šåŒ–)
â”‚   â”‚   â”‚   â”œâ”€â”€ base_panel.go
â”‚   â”‚   â”‚   â”œâ”€â”€ ticker_panel.go
â”‚   â”‚   â”‚   â”œâ”€â”€ trades_panel.go
â”‚   â”‚   â”‚   â”œâ”€â”€ candles_panel.go
â”‚   â”‚   â”‚   â”œâ”€â”€ books_panel.go
â”‚   â”‚   â”‚   â””â”€â”€ status_panel.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ rest/               # RESTãƒ‡ãƒ¼ã‚¿å–å¾— (åˆ†å‰²å¾Œ)
â”‚   â”‚   â”‚   â”œâ”€â”€ panel.go
â”‚   â”‚   â”‚   â”œâ”€â”€ state.go
â”‚   â”‚   â”‚   â””â”€â”€ collectors/
â”‚   â”‚   â”‚       â”œâ”€â”€ candles.go
â”‚   â”‚   â”‚       â”œâ”€â”€ trades.go
â”‚   â”‚   â”‚       â””â”€â”€ tickers.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ components/         # å†åˆ©ç”¨å¯èƒ½ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ toggle_button.go
â”‚   â”‚   â”‚   â”œâ”€â”€ symbol_search.go
â”‚   â”‚   â”‚   â”œâ”€â”€ datetime_picker.go
â”‚   â”‚   â”‚   â”œâ”€â”€ top_bar.go
â”‚   â”‚   â”‚   â””â”€â”€ bottom_bar.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â””â”€â”€ file_controller.go
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ state/              # GUIã‚¹ãƒ†ãƒ¼ãƒˆ
â”‚   â”‚       â””â”€â”€ app_state.go
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ config_refresh.go
â”‚   â”‚   â”œâ”€â”€ file_scanner.go
â”‚   â”‚   â””â”€â”€ file_reader.go
â”‚   â”‚
â”‚   â””â”€â”€ domain/                 # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
â”‚       â””â”€â”€ file_item.go
â”‚
â”œâ”€â”€ pkg/                        # å¤–éƒ¨å…¬é–‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”‚   â””â”€â”€ schema/
â”‚       â””â”€â”€ types.go
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ WEBSOCKET_CONFIG.md
â”‚   â”œâ”€â”€ CLAUDE.md
â”‚   â””â”€â”€ kaizen_note.md          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”‚
â”œâ”€â”€ examples/                   # ã‚µãƒ³ãƒ—ãƒ«ãƒ»ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â””â”€â”€ test_config_system.go
â”‚
â”œâ”€â”€ data/                       # ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (.gitignore)
â”œâ”€â”€ Makefile
â”œâ”€â”€ go.mod
â””â”€â”€ go.sum
```

### 8.2 å‰Šé™¤ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«

```
âŒ internal/ui/                  â†’ å‰Šé™¤ (å®Œå…¨æœªä½¿ç”¨)
âŒ internal/state/               â†’ å‰Šé™¤ (æœªä½¿ç”¨)
âŒ internal/bitfinex/            â†’ å‰Šé™¤ (ç©º)
âŒ internal/book/                â†’ å‰Šé™¤ (ç©º)
âŒ internal/metrics/             â†’ å‰Šé™¤ (ç©º)
âŒ internal/models/              â†’ å‰Šé™¤ (ç©º)
âŒ config/backups/               â†’ å‰Šé™¤ (ç©º)
âŒ config/profiles/              â†’ å‰Šé™¤ (ç©º)
âŒ config/tmp/                   â†’ å‰Šé™¤ (ç©º)
âŒ config/bitfinex_config.yml   â†’ ç§»å‹•/çµ±åˆ
âŒ config/state.yml              â†’ ç§»å‹•/çµ±åˆ
âŒ rest_data_panel.go           â†’ å‰Šé™¤ (æ—§ç‰ˆ)
âŒ gui_stub.go                  â†’ çµ±åˆ
```

### 8.3 ç§»å‹•ãƒ»ãƒªãƒãƒ¼ãƒ 

```
config/config.yml               â†’ config/app.yml
config/exchanges/bitfinex_config.yml â†’ config/exchanges/bitfinex.yml
config/state/state.yml          â†’ config/runtime/state.yml
```

---

## 9. å®Ÿè£…å„ªå…ˆåº¦

### Priority 1: å³åº§ã«å®Ÿè¡Œå¯èƒ½ (ãƒªã‚¹ã‚¯ä½)
1. âœ… ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤
2. âœ… æœªä½¿ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤ (`internal/ui/`, `internal/state/`)
3. âœ… æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤ (`rest_data_panel.go`)
4. âœ… ã‚¹ã‚¿ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±åˆ
5. âœ… è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´ç†ãƒ»ç§»å‹•

**æœŸé–“**: 1-2æ™‚é–“
**åŠ¹æœ**: ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ç´„20%å‰Šæ¸›ã€æ§‹é€ ã®æ˜ç¢ºåŒ–

### Priority 2: ä¸­æœŸæ”¹å–„ (ãƒªã‚¹ã‚¯ä¸­)
1. â³ ãƒãƒ£ãƒãƒ«ãƒ‘ãƒãƒ«ã®å…±é€šåŒ–
2. â³ REST ãƒ‡ãƒ¼ã‚¿ãƒ‘ãƒãƒ«ã®åˆ†å‰²
3. â³ WebSocketæ¥ç¶šç®¡ç†ã®åˆ†å‰²

**æœŸé–“**: 1-2é€±é–“
**åŠ¹æœ**: ç´„2,000è¡Œå‰Šæ¸›ã€ä¿å®ˆæ€§å‘ä¸Š

### Priority 3: é•·æœŸæ”¹å–„ (ãƒªã‚¹ã‚¯é«˜)
1. ğŸ”² ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å…¨é¢è¦‹ç›´ã—
2. ğŸ”² ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®å‘ä¸Š
3. ğŸ”² ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ•´å‚™

---

## 10. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿæ–½è¨ˆç”»

### Phase 1: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (1-2æ—¥)

**Day 1: å‰Šé™¤ä½œæ¥­**
```bash
# 1. æœªä½¿ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤
rm -rf internal/ui
rm -rf internal/state
rm -rf internal/bitfinex
rm -rf internal/book
rm -rf internal/metrics
rm -rf internal/models
rm -rf config/backups
rm -rf config/profiles
rm -rf config/tmp

# 2. æœªä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
rm internal/gui/rest_data_panel.go
rm cmd/data-controller/gui_stub.go  # ã¾ãŸã¯ stub_gui.go

# 3. ãƒ“ãƒ«ãƒ‰ç¢ºèª
make build-gui
./data-controller-gui  # å‹•ä½œç¢ºèª
```

**Day 2: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†**
```bash
# 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p config/runtime
mkdir -p config/exchanges

# 2. ãƒ•ã‚¡ã‚¤ãƒ«ç§»å‹•ãƒ»ãƒªãƒãƒ¼ãƒ 
mv config/config.yml config/app.yml
mv config/state/state.yml config/runtime/state.yml
mv config/exchanges/bitfinex_config.yml config/exchanges/bitfinex.yml
rm config/bitfinex_config.yml  # é‡è¤‡å‰Šé™¤
rm config/state.yml             # é‡è¤‡å‰Šé™¤
rmdir config/state              # ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå‰Šé™¤

# 3. ã‚³ãƒ¼ãƒ‰å´ã®ä¿®æ­£
# config loaderã®ãƒ‘ã‚¹æ›´æ–°ãŒå¿…è¦
```

### Phase 2: ã‚³ãƒ¼ãƒ‰åˆ†å‰² (1é€±é–“)

**Week 1: ãƒãƒ£ãƒãƒ«ãƒ‘ãƒãƒ«å…±é€šåŒ–**
1. `BaseChannelPanel` å®Ÿè£…
2. å„ãƒãƒ£ãƒãƒ«ãƒ‘ãƒãƒ«ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
3. ãƒ†ã‚¹ãƒˆå®Ÿæ–½

### Phase 3: å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰² (1é€±é–“)

**Week 2: REST & WebSocketåˆ†å‰²**
1. `rest_data_panel_v2.go` åˆ†å‰²
2. `ws/conn.go` åˆ†å‰²
3. ãƒ†ã‚¹ãƒˆå®Ÿæ–½

---

## 11. ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ç¾çŠ¶
- **ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 66å€‹
- **ç·è¡Œæ•°**: 16,867è¡Œ
- **1000è¡Œè¶…ãƒ•ã‚¡ã‚¤ãƒ«**: 1å€‹
- **500-1000è¡Œãƒ•ã‚¡ã‚¤ãƒ«**: 4å€‹
- **æœªä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«**: ç´„10å€‹ (1,500è¡Œ)
- **ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: 7å€‹

### ç›®æ¨™ (Phase 1å®Œäº†å¾Œ)
- **ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: ç´„55å€‹ (-11å€‹)
- **ç·è¡Œæ•°**: ç´„15,300è¡Œ (-1,500è¡Œ)
- **1000è¡Œè¶…ãƒ•ã‚¡ã‚¤ãƒ«**: 0å€‹
- **500-1000è¡Œãƒ•ã‚¡ã‚¤ãƒ«**: 2-3å€‹
- **æœªä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«**: 0å€‹
- **ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: 0å€‹

### ç›®æ¨™ (Phase 2-3å®Œäº†å¾Œ)
- **ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: ç´„60-65å€‹
- **ç·è¡Œæ•°**: ç´„14,000è¡Œ (-2,800è¡Œ)
- **æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º**: 500è¡Œä»¥ä¸‹
- **å¹³å‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º**: 200-250è¡Œ

---

## 12. ãƒªã‚¹ã‚¯è©•ä¾¡

### ä½ãƒªã‚¹ã‚¯ä½œæ¥­
- âœ… ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤
- âœ… æœªä½¿ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (`internal/ui`, `internal/state`) ã®å‰Šé™¤
- âœ… æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ« (`rest_data_panel.go`) ã®å‰Šé™¤

**ç†ç”±**: ã“ã‚Œã‚‰ã¯ã©ã“ã‹ã‚‰ã‚‚å‚ç…§ã•ã‚Œã¦ã„ãªã„

### ä¸­ãƒªã‚¹ã‚¯ä½œæ¥­
- âš ï¸ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç§»å‹•ãƒ»çµ±åˆ
- âš ï¸ ã‚¹ã‚¿ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ±åˆ

**ç†ç”±**: ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°ã‚„ãƒ­ãƒ¼ãƒ‰ãƒ‘ã‚¹ã®å¤‰æ›´ãŒå¿…è¦

**å¯¾ç­–**:
- ãƒ“ãƒ«ãƒ‰å¾Œã®å‹•ä½œç¢ºèªã‚’å¾¹åº•
- è¨­å®šãƒ­ãƒ¼ãƒ‰å‡¦ç†ã®ãƒ†ã‚¹ãƒˆè¿½åŠ 

### é«˜ãƒªã‚¹ã‚¯ä½œæ¥­
- ğŸš¨ å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†å‰²
- ğŸš¨ å…±é€šåŸºç›¤ã®ä½œæˆ

**ç†ç”±**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å¤‰æ›´ã‚’ä¼´ã†

**å¯¾ç­–**:
- æ®µéšçš„ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- å„ã‚¹ãƒ†ãƒƒãƒ—ã§ãƒ†ã‚¹ãƒˆå®Ÿæ–½
- ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°ã®æ´»ç”¨

---

## 13. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã«å®Ÿè¡Œã™ã¹ãã‚¢ã‚¯ã‚·ãƒ§ãƒ³
1. ã“ã®ãƒãƒ¼ãƒˆã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼
2. Priority 1 ã®å‰Šé™¤ä½œæ¥­ã‚’å®Ÿæ–½
3. ãƒ“ãƒ«ãƒ‰ãƒ»å‹•ä½œç¢ºèª
4. Git commit

### æ‰¿èªãŒå¿…è¦ãªäº‹é …
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ å¤‰æ›´
- å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†å‰²æ–¹é‡

### è¿½åŠ èª¿æŸ»ãŒå¿…è¦ãªäº‹é …
- `examples/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰±ã„ (å‰Šé™¤ or docs/ ã¸ç§»å‹•?)
- å°†æ¥ã®å–å¼•æ‰€è¿½åŠ æ™‚ã®æ‹¡å¼µæ€§
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®é…ç½®æ–¹é‡

---

## 14. çµè«–

### ä¸»ãªç™ºè¦‹
1. **ç´„20%ã®ã‚³ãƒ¼ãƒ‰ãŒæœªä½¿ç”¨ã¾ãŸã¯é‡è¤‡**
2. **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ ãŒä¸æ˜ç¢º**
3. **å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å®ˆæ€§ã‚’ä½ä¸‹ã•ã›ã¦ã„ã‚‹**
4. **ãƒãƒ£ãƒãƒ«ãƒ‘ãƒãƒ«ã®å®Ÿè£…ãŒå†—é•·**

### æ”¹å–„ã®åŠ¹æœ
- **ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹å‰Šæ¸›**: ç´„2,800è¡Œ (17%å‰Šæ¸›)
- **ãƒ•ã‚¡ã‚¤ãƒ«æ•°å‰Šæ¸›**: ç´„11å€‹
- **ä¿å®ˆæ€§å‘ä¸Š**: è²¬å‹™ã®æ˜ç¢ºåŒ–ã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§å‘ä¸Š
- **æ‹¡å¼µæ€§å‘ä¸Š**: å°†æ¥ã®å–å¼•æ‰€è¿½åŠ ãŒå®¹æ˜“

### æ¨å¥¨äº‹é …
**ä»Šã™ãå®Ÿæ–½**: Priority 1 (ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—)
**è¿‘æ—¥ä¸­ã«å®Ÿæ–½**: Priority 2 (ã‚³ãƒ¼ãƒ‰åˆ†å‰²)
**ç¶™ç¶šçš„ã«å®Ÿæ–½**: ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ–‡åŒ–ã®é†¸æˆ

---

**ãƒ¬ãƒ“ãƒ¥ãƒ¼è€…**: [åå‰]
**æ‰¿èªæ—¥**: [æ—¥ä»˜]
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼**: [æ—¥ä»˜]

---

## è¿½åŠ ãƒ¡ãƒ¢ (2025-10-01)

### A. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²å†ç¢ºèª
- `config/exchanges/bitfinex_config.yml` ã¯ `ConfigManager.Initialize()` ãŒç›´æ¥èª­ã¿è¾¼ã‚€å”¯ä¸€ã®ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸è¨­å®šã§ã™ã€‚REST ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚„ãƒãƒ¼ãƒãƒ©ã‚¤ã‚¶ã®æ—¢å®šå€¤ã‚‚ã“ã“ã«ç´ã¥ããŸã‚ã€ã€Œé‡è¤‡ã€ã¨ã¿ãªã—ã¦å‰Šé™¤ã™ã‚‹ã¨èµ·å‹•ç›´å¾Œã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¤±æ•—ã—ã¾ã™ã€‚
- `config/bitfinex_config.yml` ã¯æ—§ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®åœ¨åº«ã§ã€ç¾è¡Œã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã¯å‚ç…§ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚å‰Šé™¤ã™ã‚‹å ´åˆã¯ README ã¨ GUI ã®èª¬æ˜ã‚’åŒæ™‚æ›´æ–°ã—ã€`docs/WEBSOCKET_CONFIG.md` ã®æ‰‹é †ãŒé€¸è„±ã—ãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚é€†ã«æ´»ç”¨ã™ã‚‹ã®ã§ã‚ã‚Œã°ã€`ConfigManager` å´ã§ã®èª­ã¿å–ã‚Šå…ˆã‚’ä¸€å…ƒåŒ–ã™ã‚‹è¨­è¨ˆãŒå¦¥å½“ã§ã™ã€‚
- `config/state.yml` (REST è¨­å®šã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€çµ‚æ›´æ–°æ™‚åˆ») ã¨ `config/state/state.yml` (GUIãƒ»WS çŠ¶æ…‹) ã¯ç”¨é€”ãŒç•°ãªã‚Šã¾ã™ã€‚çµ±åˆã™ã‚‹å‰ã«ã€`ApplicationState` ã¨ REST ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç† (`UpdateRestConfigCache`) ã®ä¿å­˜å…ˆãŒãƒãƒ©ãƒãƒ©ã«ãªã£ã¦ã„ã‚‹ç‚¹ã‚’è¨­è¨ˆã¨ã—ã¦æ˜ç¤ºã—ã€2ç¨®é¡ã®çŠ¶æ…‹ãƒ‡ãƒ¼ã‚¿ã‚’ã©ã“ã§æ‰±ã†ã‹æ•´ç†ã™ã‚‹ã¨è¿·å­ã«ãªã‚Šã¥ã‚‰ããªã‚Šã¾ã™ã€‚

### B. æœªä½¿ç”¨ï¼ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ‰±ã„
- `internal/bitfinex`, `internal/book`, `internal/metrics`, `internal/models` ãªã©ã¯å®Œå…¨ã«ç©ºã§ã‚ã‚Šã€ç¾è¡Œãƒ“ãƒ«ãƒ‰ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ã€‚å‰Šé™¤ã™ã‚‹å ´åˆã¯ `go list ./...` ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¾å­˜ã«å¤‰å‹•ãŒãªã„ã“ã¨ã‚’ç¢ºèªã—ã€å°†æ¥ã®æ‹¡å¼µäºˆå®šãŒãªã„ã‹ã‚ªãƒ¼ãƒŠãƒ¼ç¢ºèªã‚’è¡Œã£ã¦ãã ã•ã„ã€‚
- `internal/ui/` ã¨ `internal/state/` ã¯æ—§ GUI å®Ÿè£…ã®ç—•è·¡ã§ã™ãŒã€`go:build` ã‚¿ã‚°ãªã©ã¯ä»˜ä¸ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚`grep -R "internal/ui"` ã§ã‚‚ç¾è¡Œãƒ‘ã‚¹ã‹ã‚‰å‚ç…§ãŒç„¡ã„ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿ãªã®ã§ã€Phase 1 ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å€™è£œã¨ã—ã¦å®‰å…¨åœã§ã™ã€‚å‰Šé™¤ã™ã‚‹éš›ã¯ `go build ./cmd/data-controller` ã§ GUI ãƒ“ãƒ«ãƒ‰ãŒå£Šã‚Œãªã„ã‹æœ€çµ‚ç¢ºèªã™ã‚‹ã®ãŒç¢ºå®Ÿã§ã™ã€‚

### C. å¤§å‹ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†å‰²ã«å‘ã‘ãŸè¿½åŠ ãƒ’ãƒ³ãƒˆ
- `rest_data_panel_v2.go` ã®è‚¥å¤§åŒ–ã¯ã‚¿ãƒ–ã”ã¨ã® UI ã¨ãƒãƒƒãƒåˆ¶å¾¡ãŒå¯†çµåˆã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒä¸»å› ã§ã™ã€‚`RunContext` ã‚„ `JobRunner` ã®ã‚ˆã†ãªå°ã•ãªã‚µãƒ¼ãƒ“ã‚¹å±¤ã‚’åˆ‡ã‚Šå‡ºã—ã€UI å±¤ (`RestDataPanelV2`) ã‹ã‚‰ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„ãƒ—ãƒ¬ãƒ¼ãƒ³ãª DTO ã®ã¿æ¸¡ã™æ§‹é€ ã«ã™ã‚‹ã¨ 1 ãƒ•ã‚¡ã‚¤ãƒ« 400 è¡Œç¨‹åº¦ã¾ã§ç¸®å°ã§ãã¾ã™ã€‚
- `ws/conn.go` ã¯æ¥ç¶šç®¡ç†ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ãŒæ··åœ¨ã—ã¦ã„ã‚‹ã®ã§ã€`message_loop.go` (å—ä¿¡å‡¦ç†) ã¨ `connection.go` (æ¥ç¶šãƒ»å†æ¥ç¶šåˆ¶å¾¡) ã«äºŒåˆ†ã™ã‚‹æ–¹é‡ãŒæ‰±ã„ã‚„ã™ã„ã§ã™ã€‚ãã®éš› `Router` ã¸ã®ä¾å­˜æ€§æ³¨å…¥ãƒã‚¤ãƒ³ãƒˆã‚’ 1 ç®‡æ‰€ã«é›†ç´„ã™ã‚‹ã¨ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ããªã‚Šã¾ã™ã€‚

### D. ä»Šå¾Œã®å®Ÿè¡Œã‚¹ãƒ†ãƒƒãƒ—ææ¡ˆ
1. `config` é…ä¸‹ã®å½¹å‰²ã‚’ README/WEBSOCKET_CONFIG åŒæ–¹ã§åŒæœŸã—ã€ã€Œå®Ÿéš›ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã€ã¨ã€Œæ—§ãƒªã‚½ãƒ¼ã‚¹ã€ã‚’è¡¨å½¢å¼ã§æ˜ç¤ºã™ã‚‹ã€‚
2. å„ªå…ˆåº¦ãŒä½ã„ç©ºãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å‰Šé™¤ã§ã‚‚ `git clean` ã§ã¯ãªãå€‹åˆ¥å‰Šé™¤ï¼‹ãƒ“ãƒ«ãƒ‰æ¤œè¨¼ã‚’ãƒ«ãƒ¼ãƒ«åŒ–ã—ã€èª¤ã£ã¦ç”Ÿæˆå…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šã‚‰ãªã„ã‚ˆã†æ³¨æ„å–šèµ·ã™ã‚‹ã€‚
3. å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†å‰²ã¯æŠ½è±¡å±¤ã®å†è¨­è¨ˆã‚’ä¼´ã†ãŸã‚ã€ã¾ãš `rest_data_panel_v2.go` ã§ `ctx` ã¨ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆé–¢é€£ã‚’ `rest/jobs` ã‚µãƒ–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¸åˆ‡ã‚Šå‡ºã™ PoC ã‚’è¡Œã„ã€æˆåŠŸã—ãŸã‚‰ WebSocket å´ã«ã‚‚å±•é–‹ã™ã‚‹ã€‚

ï¼ˆè¿½è¨˜è€…: system reviewï¼‰
