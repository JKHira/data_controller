# Data Controller

æš—å·é€šè²¨AIè‡ªå‹•å–å¼•ã‚·ã‚¹ãƒ†ãƒ ã®ä¸­æ ¸ã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ç®¡ç†ãƒ»åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ 

---

## ğŸ“‹ ç›®æ¬¡

- [æ¦‚è¦](#æ¦‚è¦)
- [ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ](#ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ)
- [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ](#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ )
- [è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«](#è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«)
- [ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ](#ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)
- [WebSocketè¨­å®šã‚·ã‚¹ãƒ†ãƒ ](#websocketè¨­å®šã‚·ã‚¹ãƒ†ãƒ )
- [GUIæ§‹æˆ](#guiæ§‹æˆ)
- [ãƒ‡ãƒ¼ã‚¿ä¿å­˜](#ãƒ‡ãƒ¼ã‚¿ä¿å­˜)
- [å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)
- [ä½¿ç”¨äºˆå®šAIãƒ¢ãƒ‡ãƒ«](#ä½¿ç”¨äºˆå®šaiãƒ¢ãƒ‡ãƒ«)
- [å‚è€ƒãƒªãƒ³ã‚¯](#å‚è€ƒãƒªãƒ³ã‚¯)

---

## æ¦‚è¦

**Data Controller**ã¯ã€æš—å·é€šè²¨å–å¼•æ‰€ã‹ã‚‰ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€AIäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã¸ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã€å–å¼•åˆ¤æ–­ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®çµ±åˆåˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### ä¸»è¦æ©Ÿèƒ½

- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿å–å¾—**: WebSocketã«ã‚ˆã‚‹è¤‡æ•°å–å¼•æ‰€ã‹ã‚‰ã®ä¸¦è¡Œãƒ‡ãƒ¼ã‚¿å–å¾—
- **ãƒ‡ãƒ¼ã‚¿æ­£è¦åŒ–**: å–å¼•æ‰€ã”ã¨ã®å·®ç•°ã‚’å¸åã™ã‚‹çµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
- **çŠ¶æ…‹ç®¡ç†**: æ¥ç¶šçŠ¶æ…‹ãƒ»è³¼èª­æƒ…å ±ã®æ°¸ç¶šåŒ–
- **GUIåˆ¶å¾¡**: Fyneè£½ã®ç›´æ„Ÿçš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **é«˜æ€§èƒ½ä¿å­˜**: Apache Arrowã«ã‚ˆã‚‹åˆ—æŒ‡å‘ãƒ‡ãƒ¼ã‚¿ä¿å­˜
- **è‡ªå‹•è¨­å®šæ›´æ–°**: REST APIã‹ã‚‰ã®å‹•çš„è¨­å®šå–å¾—

### é–‹ç™ºç’°å¢ƒ

- **è¨€èª**: Go 1.25+
- **ã‚·ã‚¹ãƒ†ãƒ **: macOS (Apple Silicon) / M1 Max 64GB
- **GUI**: Fyne v2.6
- **ãƒ‡ãƒ¼ã‚¿å½¢å¼**: Apache Arrow
- **è¨­å®š**: YAML

---

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

### Trade Engineï¼ˆå¸¸é§1ãƒ—ãƒ­ã‚»ã‚¹ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Data Controller                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WSå–è¾¼ â†’ æ­£è¦åŒ– â†’ ç‰¹å¾´ç”Ÿæˆ â†’ MLX/CPUè¨ˆç®— â†’ ãƒˆãƒ¬ãƒ¼ãƒ‰åˆ¶å¾¡ â”‚
â”‚   â†“                                          â†“           â”‚
â”‚ Apache Arrowä¿å­˜                     Freqtradeé€£æº      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸»è¦å‡¦ç†ãƒ•ãƒ­ãƒ¼

1. **WSå–è¾¼**: å–å¼•æ‰€WebSocketã‹ã‚‰ä¸¦è¡Œãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆè‡ªå‹•å†æ¥ç¶šãƒ»ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆï¼‰
2. **æ­£è¦åŒ–**: å–å¼•æ‰€ã”ã¨ã®è¡¨è¨˜å·®ç•°ã‚’çµ±ä¸€ï¼ˆä¾‹: `tBTCUSD` â†’ `BTC-USD`ï¼‰
3. **ç‰¹å¾´ç”Ÿæˆ**: 1-5ç§’ã§OFI/ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰åˆ†ä½ã‚’å›ºå®šé•·float32é…åˆ—åŒ–
4. **MLX/CPUè¨ˆç®—**:
   - æœ€é€Ÿ: cgoã§Cãƒ©ãƒƒãƒ‘é–¢æ•°ç›´æ¥å‘¼ã³å‡ºã—
   - æ¬¡å–„: gRPC/UDSã§å¸¸é§MLXã‚µãƒ¼ãƒã«ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
5. **ãƒˆãƒ¬ãƒ¼ãƒ‰åˆ¶å¾¡**: Freqtrade REST APIã§forcebuy/forcesell/start/stop
6. **ä¿å­˜**: Apache Arrowï¼ˆç”ŸL2ãƒ‡ãƒ¼ã‚¿ï¼‰ + InfluxDBï¼ˆç‰¹å¾´é‡ãƒ»è¦ç´„ï¼‰

### å¯è¦–åŒ–

- **Grafana**: InfluxDB/Prometheusãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–
- **Fyne GUI**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´ç”¨ã®è»½é‡UI

### èµ·å‹•ãƒ»å¾©æ—§

- **launchd**: è‡ªå‹•å†èµ·å‹•ãƒ»ãƒ­ã‚°å›åï¼ˆmacOSï¼‰

---

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
data_controller/
â”œâ”€â”€ cmd/                              # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â””â”€â”€ data-controller/
â”‚       â”œâ”€â”€ main.go                  # ãƒ¡ã‚¤ãƒ³èµ·å‹•ãƒ­ã‚¸ãƒƒã‚¯
â”‚       â”œâ”€â”€ fyne_gui.go              # GUIåˆæœŸåŒ–
â”‚       â”œâ”€â”€ gui.go                   # GUIæœ‰åŠ¹åŒ–ãƒ•ãƒ©ã‚°
â”‚       â””â”€â”€ nogui.go                 # CLIå®Ÿè¡Œãƒ­ã‚¸ãƒƒã‚¯
â”‚
â”œâ”€â”€ config/                          # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ config.yml                   # ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š
â”‚   â”œâ”€â”€ bitfinex_config.yml          # ãƒ¬ã‚¬ã‚·ãƒ¼Bitfinexè¨­å®š
â”‚   â”œâ”€â”€ exchanges/                   # å–å¼•æ‰€å›ºæœ‰è¨­å®š
â”‚   â”‚   â””â”€â”€ bitfinex_config.yml     # æ–°Bitfinexè¨­å®šï¼ˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒ»åˆ¶é™ï¼‰
â”‚   â”œâ”€â”€ profiles/                    # ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
â”‚   â”œâ”€â”€ state/                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
â”‚   â”‚   â””â”€â”€ state.yml               # æ¥ç¶šçŠ¶æ…‹ãƒ»è³¼èª­æƒ…å ±ãƒ»UIçŠ¶æ…‹
â”‚   â”œâ”€â”€ backups/                     # è‡ªå‹•è¨­å®šãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
â”‚   â””â”€â”€ tmp/                         # ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ­ãƒƒã‚¯
â”‚       â””â”€â”€ update.lock             # è¨­å®šæ›´æ–°æ™‚ã®æ’ä»–åˆ¶å¾¡
â”‚
â”œâ”€â”€ data/                            # ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆ
â”‚   â””â”€â”€ bitfinex/
â”‚       â”œâ”€â”€ websocket/               # WebSocketãƒ‡ãƒ¼ã‚¿
â”‚       â”‚   â”œâ”€â”€ trades/             # å–å¼•ãƒ‡ãƒ¼ã‚¿ï¼ˆArrowå½¢å¼ï¼‰
â”‚       â”‚   â”œâ”€â”€ books/              # æ¿ãƒ‡ãƒ¼ã‚¿ï¼ˆArrowå½¢å¼ï¼‰
â”‚       â”‚   â””â”€â”€ ticker/             # ãƒ†ã‚£ãƒƒã‚«ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆArrowå½¢å¼ï¼‰
â”‚       â””â”€â”€ restapi/                 # REST APIãƒ‡ãƒ¼ã‚¿
â”‚           â””â”€â”€ config/              # å–å¼•æ‰€è¨­å®šã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚               â”œâ”€â”€ list_pair_exchange.json      # ã‚¹ãƒãƒƒãƒˆå–å¼•ãƒšã‚¢
â”‚               â”œâ”€â”€ list_pair_margin.json        # ãƒãƒ¼ã‚¸ãƒ³å–å¼•ãƒšã‚¢
â”‚               â”œâ”€â”€ list_pair_futures.json       # å…ˆç‰©å¥‘ç´„
â”‚               â”œâ”€â”€ map_currency_label.json      # é€šè²¨æ­£å¼åç§°
â”‚               â””â”€â”€ *.json                       # ãã®ä»–è¨­å®š
â”‚
â”œâ”€â”€ internal/                        # å†…éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ config/                      # è¨­å®šç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.go               # è¨­å®šæ§‹é€ ä½“å®šç¾©
â”‚   â”‚   â”œâ”€â”€ loader.go               # YAMLè¨­å®šèª­ã¿è¾¼ã¿
â”‚   â”‚   â”œâ”€â”€ config_manager.go       # è¨­å®šãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ state.go                # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ normalizer.go           # é€šè²¨ãƒšã‚¢æ­£è¦åŒ–ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”‚   â”œâ”€â”€ exchange_config.go      # å–å¼•æ‰€è¨­å®šæ§‹é€ ä½“
â”‚   â”‚   â”œâ”€â”€ file_lock.go            # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒƒã‚¯æ©Ÿæ§‹
â”‚   â”‚   â””â”€â”€ rest_fetcher.go         # REST APIå–å¾—ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                      # ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â””â”€â”€ file_item.go            # ãƒ•ã‚¡ã‚¤ãƒ«é …ç›®ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚
â”‚   â”œâ”€â”€ gui/                         # GUIã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”œâ”€â”€ app/                    # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”‚   â”‚   â””â”€â”€ app.go              # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªæ§‹é€ 
â”‚   â”‚   â”œâ”€â”€ controllers/            # ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å±¤
â”‚   â”‚   â”‚   â””â”€â”€ file_controller.go  # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ panels/                 # ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”‚   â”‚   â”œâ”€â”€ files_panel.go      # ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ viewer_panel.go     # ãƒ•ã‚¡ã‚¤ãƒ«ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼
â”‚   â”‚   â”œâ”€â”€ state/                  # GUIçŠ¶æ…‹ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ app_state.go        # GUIçŠ¶æ…‹
â”‚   â”‚   â”œâ”€â”€ panes_v2.go             # WebSocket/REST ãƒ‘ãƒãƒ«æ§‹æˆ
â”‚   â”‚   â”œâ”€â”€ rest_api_panel.go       # REST Config + Data ã‚¿ãƒ–
â”‚   â”‚   â”œâ”€â”€ rest_data_panel.go      # RESTãƒ‡ãƒ¼ã‚¿å–å¾—UI
â”‚   â”‚   â”œâ”€â”€ websocket_panel.go      # WebSocketè¨­å®šãƒ‘ãƒãƒ«
â”‚   â”‚   â”œâ”€â”€ channel_ticker.go       # Tickerãƒãƒ£ãƒ³ãƒãƒ«è¨­å®š
â”‚   â”‚   â”œâ”€â”€ channel_trades.go       # Tradesãƒãƒ£ãƒ³ãƒãƒ«è¨­å®š
â”‚   â”‚   â”œâ”€â”€ channel_books.go        # Booksãƒãƒ£ãƒ³ãƒãƒ«è¨­å®š
â”‚   â”‚   â”œâ”€â”€ channel_candles.go      # Candlesãƒãƒ£ãƒ³ãƒãƒ«è¨­å®š
â”‚   â”‚   â”œâ”€â”€ channel_status.go       # Statusãƒãƒ£ãƒ³ãƒãƒ«è¨­å®š
â”‚   â”‚   â”œâ”€â”€ rest_api_panel.go       # REST APIæ“ä½œãƒ‘ãƒãƒ«
â”‚   â”‚   â”œâ”€â”€ top_bar.go              # ä¸Šéƒ¨ãƒãƒ¼
â”‚   â”‚   â”œâ”€â”€ bottom_bar.go           # ä¸‹éƒ¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒ¼
â”‚   â”‚   â”œâ”€â”€ data_files.go           # ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ãƒãƒ«
â”‚   â”‚   â”œâ”€â”€ file_viewer.go          # ãƒ•ã‚¡ã‚¤ãƒ«è¡¨ç¤ºå…±é€šæ©Ÿèƒ½
â”‚   â”‚   â””â”€â”€ live_stream.go          # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
â”‚   â”‚
â”‚   â”œâ”€â”€ ws/                          # WebSocketå®Ÿè£…
â”‚   â”‚   â”œâ”€â”€ conn.go                 # WebSocketæ¥ç¶šç®¡ç†
â”‚   â”‚   â””â”€â”€ router.go               # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
â”‚   â”‚
â”‚   â”œâ”€â”€ restapi/                     # REST APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ bitfinex_client.go      # Bitfinex APIå®Ÿè£…
â”‚   â”‚   â”œâ”€â”€ arrow_storage.go        # Arrowã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â”‚   â”‚   â””â”€â”€ utils.go                # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚
â”‚   â”œâ”€â”€ sink/arrow/                  # ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”‚   â”œâ”€â”€ writer.go               # Arrowãƒ©ã‚¤ã‚¿ãƒ¼
â”‚   â”‚   â”œâ”€â”€ reader.go               # Arrowãƒªãƒ¼ãƒ€ãƒ¼
â”‚   â”‚   â”œâ”€â”€ schema.go               # ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â”‚   â”œâ”€â”€ handler.go              # ãƒ‡ãƒ¼ã‚¿ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
â”‚   â”‚   â””â”€â”€ channel_writer.go       # ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥ãƒ©ã‚¤ã‚¿ãƒ¼
â”‚   â”‚
â”‚   â””â”€â”€ services/                    # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚       â”œâ”€â”€ file_reader.go          # ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
â”‚       â”œâ”€â”€ file_scanner.go         # ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ã‚­ãƒ£ãƒ³
â”‚       â””â”€â”€ config_refresh.go       # è¨­å®šæ›´æ–°ã‚µãƒ¼ãƒ“ã‚¹
â”‚
â”œâ”€â”€ examples/                        # ã‚µãƒ³ãƒ—ãƒ«ãƒ»ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ test_config_system.go       # è¨­å®šã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
â”‚
â”œâ”€â”€ docs/                            # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â””â”€â”€ WEBSOCKET_CONFIG.md         # WebSocketè¨­å®šã‚·ã‚¹ãƒ†ãƒ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚
â”œâ”€â”€ CLAUDE.md                        # AIé–‹ç™ºæŒ‡é‡
â”œâ”€â”€ README.md                        # æœ¬ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ go.mod                           # Goä¾å­˜é–¢ä¿‚
â””â”€â”€ Makefile                         # ãƒ“ãƒ«ãƒ‰è¨­å®š
```

---

## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

### ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®š (`config/config.yml`)

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®åŸºæœ¬è¨­å®š

```yaml
application:
  name: "data-controller"
  version: "1.0.0"
  log_level: "debug"

storage:
  base_path: "/path/to/data"
  compression: "zstd"

gui:
  title: "Data Controller"
  width: 800
  height: 600
  theme: "dark"

exchanges:
  default: "bitfinex"
  entries:
    bitfinex:
      default_profile: "default"
      active_profile: "default"
```

**ä¸»è¦é …ç›®:**
- `application`: ã‚¢ãƒ—ãƒªåãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ»ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
- `storage`: ãƒ‡ãƒ¼ã‚¿ä¿å­˜å…ˆãƒ‘ã‚¹ãƒ»åœ§ç¸®è¨­å®š
- `gui`: GUIè¨­å®šï¼ˆã‚µã‚¤ã‚ºãƒ»ãƒ†ãƒ¼ãƒï¼‰
- `exchanges`: å–å¼•æ‰€ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†

### å–å¼•æ‰€è¨­å®š (`config/exchanges/bitfinex_config.yml`)

å–å¼•æ‰€å›ºæœ‰ã®ä»•æ§˜ãƒ»åˆ¶é™ãƒ»ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤

```yaml
endpoints:
  ws_public: "wss://api-pub.bitfinex.com/ws/2"
  rest_public: "https://api-pub.bitfinex.com/v2"

limits:
  ws_max_subscriptions: 30      # æœ€å¤§è³¼èª­ãƒãƒ£ãƒ³ãƒãƒ«æ•°
  rest_rate_limit: 90           # REST APIãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆreq/åˆ†ï¼‰

defaults:
  book:
    prec: "P0"                  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç²¾åº¦
    freq: "F0"                  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé »åº¦
    len: "25"                   # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé•·ã•

rest_config_endpoints:
  - endpoint: "pub:list:pair:exchange"
    cache_duration: 3600        # ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹æœŸé–“ï¼ˆç§’ï¼‰
    file: "list_pair_exchange.json"
```

**ä¸»è¦é …ç›®:**
- `endpoints`: WebSocket/REST APIã®URL
- `limits`: æ¥ç¶šåˆ¶é™ãƒ»ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- `defaults`: ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
- `rest_config_endpoints`: è‡ªå‹•å–å¾—ã™ã‚‹è¨­å®šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### çŠ¶æ…‹ãƒ•ã‚¡ã‚¤ãƒ« (`config/state/state.yml`)

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œæ™‚çŠ¶æ…‹ï¼ˆè‡ªå‹•ç®¡ç†ï¼‰

```yaml
exchanges:
  bitfinex:
    ws:
      connections:
        - id: "conn_1"
          status: "connected"
          subscriptions:
            - channel: "ticker"
              symbol: "tBTCUSD"
              chanId: 12345
      ui_state:
        active_tab: "books"
        selected_symbols: ["tBTCUSD", "tETHUSD"]
        connection_flags:
          checksum: true
          timestamp: true
    rest_config_cache:
      last_updated:
        "pub:list:pair:exchange": "2025-09-30T10:00:00Z"
```

**ä¸»è¦é …ç›®:**
- `connections`: WebSocketæ¥ç¶šçŠ¶æ…‹ãƒ»è³¼èª­æƒ…å ±
- `ui_state`: UIã®çŠ¶æ…‹ï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–ãƒ»é¸æŠã‚·ãƒ³ãƒœãƒ«ï¼‰
- `rest_config_cache`: RESTè¨­å®šã®æ›´æ–°æ™‚åˆ»

---

## ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### 1. è¨­å®šç®¡ç† (`internal/config/`)

#### ConfigManager (`config_manager.go`)
è¨­å®šã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å…¨ä½“ã‚’ç®¡ç†

**ä¸»è¦æ©Ÿèƒ½:**
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ãƒ»åˆæœŸåŒ–
- REST APIã‹ã‚‰ã®è‡ªå‹•è¨­å®šå–å¾—
- å‘¨æœŸçš„ãªè¨­å®šæ›´æ–°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°
- çŠ¶æ…‹ã®ä¿å­˜ãƒ»å¾©å…ƒ

**ä½¿ç”¨ä¾‹:**
```go
configManager := config.NewConfigManager(logger, basePath, restClient)
configManager.Initialize("bitfinex")
configManager.RefreshConfigOnConnect("bitfinex")
```

#### Normalizer (`normalizer.go`)
å–å¼•æ‰€ã”ã¨ã®è¡¨è¨˜å·®ç•°ã‚’çµ±ä¸€

**ä¸»è¦æ©Ÿèƒ½:**
- é€šè²¨ãƒšã‚¢ã®æ­£è¦åŒ–ï¼ˆ`tBTCUSD` â†’ `BTC-USD`ï¼‰
- é€†æ­£è¦åŒ–ï¼ˆ`BTC-USD` â†’ `tBTCUSD`ï¼‰
- é€šè²¨ã®æ­£å¼åç§°å–å¾—ï¼ˆ`BTC` â†’ `Bitcoin`ï¼‰

**å¯¾å¿œå½¢å¼:**
- Trading pairs: `tBTCUSD`, `tETHUSD`
- Colon format: `AVAX:BTC`, `BTC:USD`
- Funding: `fUSD` â†’ `USD-USD`
- Futures: `BTCF0:USTF0`

#### ApplicationState (`state.go`)
ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•ãªçŠ¶æ…‹ç®¡ç†

**ä¸»è¦æ©Ÿèƒ½:**
- æ¥ç¶šçŠ¶æ…‹ã®è¿½è·¡
- è³¼èª­æƒ…å ±ã®ç®¡ç†
- UIçŠ¶æ…‹ã®æ°¸ç¶šåŒ–
- RESTè¨­å®šã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†

#### FileLock (`file_lock.go`)
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã®æ’ä»–åˆ¶å¾¡

**ä¸»è¦æ©Ÿèƒ½:**
- Flock-based ãƒ•ã‚¡ã‚¤ãƒ«ãƒ­ãƒƒã‚¯
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆä»˜ãæ’ä»–åˆ¶å¾¡
- ãƒ­ãƒƒã‚¯æƒ…å ±ã®JSONè¨˜éŒ²

### 2. WebSocketç®¡ç† (`internal/ws/`)

#### ConnectionManager (`conn.go`)
WebSocketæ¥ç¶šã®ç®¡ç†

**ä¸»è¦æ©Ÿèƒ½:**
- è‡ªå‹•å†æ¥ç¶š
- ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆç›£è¦–
- è³¼èª­ã‚­ãƒ¥ãƒ¼ç®¡ç†
- ãƒãƒ£ãƒ³ãƒãƒ«æƒ…å ±è¿½è·¡

#### Router (`router.go`)
WebSocketãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**ä¸»è¦æ©Ÿèƒ½:**
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—åˆ¤å®š
- é©åˆ‡ãªãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¸ã®æŒ¯ã‚Šåˆ†ã‘
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### 3. ãƒ‡ãƒ¼ã‚¿ä¿å­˜ (`internal/sink/arrow/`)

#### Writer (`writer.go`)
Apache Arrowå½¢å¼ã§ã®ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿

**ä¸»è¦æ©Ÿèƒ½:**
- é«˜é€Ÿåˆ—æŒ‡å‘æ›¸ãè¾¼ã¿
- è‡ªå‹•ãƒ•ã‚¡ã‚¤ãƒ«åˆ†å‰²ï¼ˆã‚µã‚¤ã‚ºãƒ»æ™‚é–“ãƒ™ãƒ¼ã‚¹ï¼‰
- åœ§ç¸®å¯¾å¿œï¼ˆzstd/gzip/snappyï¼‰

#### Reader (`reader.go`)
Apache Arrowãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿

**ä¸»è¦æ©Ÿèƒ½:**
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ£ãƒ³
- ãƒšãƒ¼ã‚¸ãƒ³ã‚°èª­ã¿è¾¼ã¿
- ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯¾å¿œ

### 4. REST API (`internal/restapi/`)

#### BitfinexClient (`bitfinex_client.go`)
Bitfinex REST APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

**ä¸»è¦æ©Ÿèƒ½:**
- è¨­å®šãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆãƒšã‚¢ä¸€è¦§ãƒ»é€šè²¨æƒ…å ±ï¼‰
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

## WebSocketè¨­å®šã‚·ã‚¹ãƒ†ãƒ 

### æ¦‚è¦

ã‚¿ãƒ–åŒ–ã•ã‚ŒãŸUIã§ç›´æ„Ÿçš„ã«WebSocketè³¼èª­ã‚’è¨­å®šã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ 

**ä¸»è¦æ©Ÿèƒ½:**
- 5ã¤ã®ãƒãƒ£ãƒ³ãƒãƒ«ã‚¿ã‚¤ãƒ—ï¼ˆTicker/Trades/Books/Candles/Statusï¼‰
- 30ãƒãƒ£ãƒ³ãƒãƒ«è³¼èª­åˆ¶é™ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
- æ¥ç¶šæ™‚ã®è‡ªå‹•è¨­å®šæ›´æ–°ï¼ˆRESTã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰
- æ¥ç¶šãƒ•ãƒ©ã‚°ï¼ˆTimestamp / Sequence / Checksum / Bulkï¼‰ã®ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯åˆ‡ã‚Šæ›¿ãˆ
- çŠ¶æ…‹ã®æ°¸ç¶šåŒ–ï¼ˆé¸æŠå†…å®¹ãƒ»ã‚¿ãƒ–ãƒ»æ¥ç¶šè¨­å®šï¼‰
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœªå–å¾—æ™‚ã®ã€ŒNo dataã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã¨å³æ™‚å–å¾—

### GUIæ§‹æˆ

#### WebSocketPanel (`internal/gui/websocket_panel.go`)
ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒãƒ« - ã‚¿ãƒ–ã¨ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼

- Bitfinexã‚¿ãƒ–ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¯ `config.ConfigManager` ã‚’ä»‹ã—ã¦ `data/bitfinex/restapi/config/*.json` ã‚’å‚ç…§
- æ¥ç¶šãƒ•ãƒ©ã‚°ç”¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’å‚™ãˆã€åˆç®—å€¤ã¯Bitfinexã® `conf` ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¸åæ˜ 
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒç©ºã®å ´åˆã€ã€ŒNo data. Do you want to fetch config data?ã€ã‚’æç¤ºã—RESTæ›´æ–°ã‚’å³å®Ÿè¡Œ

#### å„ãƒãƒ£ãƒ³ãƒãƒ«ãƒ‘ãƒãƒ«

1. **TickerChannelPanel** (`channel_ticker.go`)
   - ã‚·ãƒ³ãƒœãƒ«é¸æŠ
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¾¡æ ¼æ›´æ–°

2. **TradesChannelPanel** (`channel_trades.go`)
   - ã‚·ãƒ³ãƒœãƒ«é¸æŠ
   - ç´„å®šæƒ…å ±å–å¾—

3. **BooksChannelPanel** (`channel_books.go`)
   - ã‚·ãƒ³ãƒœãƒ«é¸æŠ
   - ç²¾åº¦è¨­å®šï¼ˆP0-P4, R0ï¼‰
   - é »åº¦è¨­å®šï¼ˆF0=ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ , F1=2ç§’é–“éš”ï¼‰
   - é•·ã•è¨­å®šï¼ˆ1/25/100/250ãƒ¬ãƒ™ãƒ«ï¼‰

4. **CandlesChannelPanel** (`channel_candles.go`)
   - ã‚·ãƒ³ãƒœãƒ«é¸æŠ
   - æ™‚é–“æ è¨­å®šï¼ˆ1m/5m/15m/30m/1h/3h/6h/12h/1D/1W/14D/1Mï¼‰

5. **StatusChannelPanel** (`channel_status.go`)
   - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚¤ãƒ—é¸æŠï¼ˆDerivatives/Liquidationï¼‰

### ä¸»è¦æ©Ÿèƒ½

#### 1. è³¼èª­åˆ¶é™ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
```
Subscriptions: 25 / 30 âš ï¸ NEAR LIMIT
Subscriptions: 30 / 30 âš ï¸ LIMIT REACHED
```

#### 2. è‡ªå‹•è¨­å®šæ›´æ–°
`config.ConfigManager` ã‚’é€šã˜ã¦ WebSocket æ¥ç¶šæ™‚ã«ä»¥ä¸‹ã‚’è‡ªå‹•å®Ÿè¡Œ:
- å–å¼•ãƒšã‚¢ï¼é€šè²¨ãƒãƒƒãƒ—ã®å–å¾—ãƒ»æ›´æ–°
- æ­£è¦åŒ–ãƒ«ãƒ¼ãƒ«ï¼ˆã‚·ãƒ³ãƒœãƒ« â†’ å†…éƒ¨è¡¨è¨˜ï¼‰ã®å†ãƒ­ãƒ¼ãƒ‰
- `config/state/state.yml` ã¸ã®æ¬¡å›æ›´æ–°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ ¼ç´

#### 3. çŠ¶æ…‹æ°¸ç¶šåŒ–
ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã§ä¿æŒ:
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ–
- é¸æŠä¸­ã®ã‚·ãƒ³ãƒœãƒ«
- ãƒãƒ£ãƒ³ãƒãƒ«è¨­å®š
- æ¥ç¶šãƒ•ãƒ©ã‚°
- RESTã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ‰åŠ¹æœŸé™

#### 4. GUI â†” è¨­å®šç®¡ç†ãƒ•ãƒ­ãƒ¼

1. `gui/app/app.go` ãŒèµ·å‹•æ™‚ã« `initialiseConfigManager` ã‚’å‘¼ã³å‡ºã—ã€`config/exchanges/bitfinex_config.yml` ã¨ REST ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’èª­ã¿è¾¼ã¿ã€‚
2. `BuildExchangePanesV2` ãŒ `ConfigManager` ã¨ WebSocket ãƒ‘ãƒãƒ«ã‚’æ¥ç¶šã—ã€ã‚¿ãƒ–UIã«æœ€æ–°ã®ã‚·ãƒ³ãƒœãƒ«ãƒªã‚¹ãƒˆã‚’æ³¨å…¥ã€‚
3. REST ãƒ‘ãƒãƒ«ã¯ [Config|Data] ã®å…¥ã‚Œå­ã‚¿ãƒ–æ§‹æˆã¨ãªã‚Šã€Config ã‚¿ãƒ–ã‹ã‚‰å¾“æ¥ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã€Data ã‚¿ãƒ–ã‹ã‚‰ Candles/Trades/Tickers History ã®å–å¾—ã‚¸ãƒ§ãƒ–ã‚’å®Ÿè¡Œã€‚
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã§ç”Ÿæˆã•ã‚ŒãŸ `WSConnectionConfig` ã¯ `handleWsConnectConfig` ã«æ¸¡ã•ã‚Œã€æ—¢å­˜ã® `ConnectionManager` ãŒç†è§£ã§ãã‚‹ `cfg.Symbols` / `cfg.Channels` ã«å¤‰æ›ã€‚
5. æ¥ç¶šæˆåŠŸå¾Œã¯ `StartPeriodicUpdates` ã«ã‚ˆã‚Š REST ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’è‡ªå‹•æ›´æ–°ã€åˆ‡æ–­æ™‚ã«ã¯ `StopPeriodicUpdates` ã¨çŠ¶æ…‹æ°¸ç¶šåŒ–ã‚’å®Ÿæ–½ã€‚
6. `handleWindowClose` ã§ã‚¢ãƒ—ãƒªçµ‚äº†æ™‚ã« `ConfigManager.Shutdown()` ã‚’å‘¼ã³å‡ºã—ã€ã‚¿ã‚¤ãƒãƒ¼åœæ­¢ã¨ `state.yml` ä¿å­˜ã‚’ä¿è¨¼ã€‚

è©³ç´°: [docs/WEBSOCKET_CONFIG.md](docs/WEBSOCKET_CONFIG.md)

---

## Bitfinex RESTãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ‘ãƒãƒ«

`rest_api_panel.go` ã¨ `rest_data_panel.go` ã§æ§‹æˆã•ã‚ŒãŸ REST ãƒ‘ãƒãƒ«ã¯ã€[Config|Data] ã® 2 å±¤ã‚¿ãƒ–æ§‹æˆã«åˆ·æ–°ã•ã‚Œã¾ã—ãŸã€‚

- **Config ã‚¿ãƒ–**: æ—¢å­˜ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€‚Essential/Daily/Optional ã®å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä¸€æ‹¬æ›´æ–°ã—ã€çµæœã¯ `data/bitfinex/restapi/config/` ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚
- **Data ã‚¿ãƒ–**: Candles / Trades / Tickers History ã®å±¥æ­´ãƒ‡ãƒ¼ã‚¿ã‚’ REST API ã‹ã‚‰åé›†ã—ã€CSV ã¨ã—ã¦ `storage.base_path/bitfinex/restapi/data/` ä»¥ä¸‹ã«ä¿å­˜ã—ã¾ã™ã€‚

### Data ã‚¿ãƒ–ã®ä¸»ãªæ©Ÿèƒ½

| ã‚«ãƒ†ã‚´ãƒª | æ©Ÿèƒ½ |
| --- | --- |
| å¯¾å¿œã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | Candles (`/v2/candles/{key}/hist`), Trades (`/v2/trades/{symbol}/hist`), Tickers History (`/v2/tickers/hist`) |
| ã‚·ãƒ³ãƒœãƒ«é¸æŠ | ConfigManager ã‹ã‚‰èª­ã¿è¾¼ã‚“ã æœ€æ–°ã®ã‚·ãƒ³ãƒœãƒ«ãƒªã‚¹ãƒˆã‚’ãƒãƒ«ãƒã‚»ãƒ¬ã‚¯ãƒˆã§æä¾› |
| ã‚¿ã‚¤ãƒ ãƒ¬ãƒ³ã‚¸ | UTC ã® `YYYY-MM-DD HH:MM:SS` å½¢å¼ã€‚æœªå…¥åŠ›æ™‚ã¯éå»24æ™‚é–“ã€œç¾åœ¨ã‚’è‡ªå‹•é©ç”¨ |
| ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ | `sort=1`ï¼ˆæ˜‡é †ï¼‰ã§ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æ¡ç”¨ã€‚`Auto-pagination` ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨é€£ç¶šå–å¾— |
| ãƒ¬ãƒ¼ãƒˆåˆ¶é™ | Candles 30/min, Trades 15/min, Tickers 30/min ã«åˆã‚ã›ãŸ per-endpoint limiter ã‚’å†…è”µ |
| ãƒ‡ãƒ¼ã‚¿å“è³ª | é‡è¤‡æ’é™¤ã€ã‚®ãƒ£ãƒƒãƒ—æ¤œå‡ºï¼ˆCandles: timeframe ã«åŸºã¥ãé–¾å€¤ï¼‰ã‚’è¨­å®šå¯èƒ½ |
| ä¿å­˜å½¢å¼ | CSVï¼ˆãƒ˜ãƒƒãƒ€ä»˜ãï¼‰ã€‚Candles/Trades ã¯ 1 ãƒ•ã‚¡ã‚¤ãƒ«/çµ„åˆã›ã€Tickers ã¯ã‚·ãƒ³ãƒœãƒ«é…åˆ—ã‚’ã¾ã¨ã‚ã¦ä¿å­˜ |
| ãƒ­ã‚°ãƒ»é€²æ— | å®Ÿè¡ŒçŠ¶æ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒ­ã‚°ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ©ãƒ™ãƒ«ã«é€æ¬¡è¡¨ç¤ºã€‚Stop ãƒœã‚¿ãƒ³ã§å®‰å…¨ã«ã‚­ãƒ£ãƒ³ã‚»ãƒ« |

CSV å‡ºåŠ›ä¾‹:

- Candles: `candles_{symbol}_{timeframe}_{timestamp}.csv` ï¼ˆåˆ—: `mts,open,close,high,low,volume,symbol,timeframe`ï¼‰
- Trades: `trades_{symbol}_{timestamp}.csv` ï¼ˆåˆ—: `id,mts,amount,price,symbol`ï¼‰
- Tickers History: `tickers_{timestamp}.csv` ï¼ˆåˆ—: `symbol,bid,bid_size,ask,...,mts`ï¼‰

å®Ÿè¡Œãƒ«ãƒ¼ãƒ—ã¯ `restapi.BitfinexDataClient` ã®å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå‘¼ã³å‡ºã—ã‚’åˆ©ç”¨ã—ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ã«å¯¾å¿œã—ãŸå®‰å…¨ãªåœæ­¢ï¼å†é–‹ãŒå¯èƒ½ã§ã™ã€‚

---

## GUIæ§‹æˆ

### ãƒ¡ã‚¤ãƒ³ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Top Bar (ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WebSocket     â”‚ â”‚ REST API                  â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚ â”‚ Ticker    â”‚ â”‚ â”‚ â”‚ Config Fetcher        â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Trades    â”‚ â”‚ â”‚ â”‚ - Pairs               â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Books     â”‚ â”‚ â”‚ â”‚ - Currencies          â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Candles   â”‚ â”‚ â”‚ â”‚ - Symbols             â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ Status    â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚                           â”‚ â”‚
â”‚ â”‚ [Connect]     â”‚ â”‚ [Fetch Config]            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Data Files    â”‚ â”‚ File Viewer               â”‚ â”‚
â”‚ â”‚ - Filter      â”‚ â”‚ - 3000 records display    â”‚ â”‚
â”‚ â”‚ - Search      â”‚ â”‚ - Read-only view          â”‚ â”‚
â”‚ â”‚ - Select      â”‚ â”‚ - Metadata info           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bottom Bar (æƒ…å ±ãƒ»è­¦å‘Šè¡¨ç¤º)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### GUIå±¤ã®æ§‹é€ 

**ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤** (`gui/app/`)
- ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹é€ 

**ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å±¤** (`gui/controllers/`)
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å‡¦ç†

**ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤** (`gui/panels/`)
- UIè¡¨ç¤ºãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ

**çŠ¶æ…‹ç®¡ç†å±¤** (`gui/state/`)
- GUIçŠ¶æ…‹ã®ç®¡ç†

---

## ãƒ‡ãƒ¼ã‚¿ä¿å­˜

### Apache Arrowå½¢å¼

**åˆ©ç‚¹:**
- åˆ—æŒ‡å‘ã«ã‚ˆã‚‹é«˜é€Ÿèª­ã¿è¾¼ã¿
- ã‚¼ãƒ­ã‚³ãƒ”ãƒ¼èª­ã¿è¾¼ã¿
- åœ§ç¸®å¯¾å¿œ
- è¤‡æ•°è¨€èªå¯¾å¿œ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
data/bitfinex/
â”œâ”€â”€ websocket/
â”‚   â”œâ”€â”€ trades/
â”‚   â”‚   â””â”€â”€ tBTCUSD/
â”‚   â”‚       â””â”€â”€ 2025-09-30_10-00-00.arrow
â”‚   â”œâ”€â”€ books/
â”‚   â”‚   â””â”€â”€ tBTCUSD/
â”‚   â”‚       â””â”€â”€ 2025-09-30_10-00-00.arrow
â”‚   â””â”€â”€ ticker/
â”‚       â””â”€â”€ tBTCUSD/
â”‚           â””â”€â”€ 2025-09-30_10-00-00.arrow
â””â”€â”€ restapi/
    â””â”€â”€ config/
        â”œâ”€â”€ list_pair_exchange.json
        â””â”€â”€ map_currency_label.json
```

### ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

å„Arrowãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä»˜ä¸:
- `exchange`: å–å¼•æ‰€å
- `symbol`: ã‚·ãƒ³ãƒœãƒ«
- `channel`: ãƒãƒ£ãƒ³ãƒãƒ«ã‚¿ã‚¤ãƒ—
- `start_time`: é–‹å§‹æ™‚åˆ»
- `end_time`: çµ‚äº†æ™‚åˆ»
- `record_count`: ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°

---

## å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ¥ç¶š
- âœ… HTTPã¯æ¥ç¶šãƒ—ãƒ¼ãƒ« + çŸ­ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
- âœ… WSã¯è‡ªå‹•å†æ¥ç¶šã¨å†è³¼èª­
- âœ… ãƒãƒ¼ãƒˆãƒ“ãƒ¼ãƒˆç›£è¦–

### å“è³ª
- âœ… ãƒãƒƒãƒåŒ–ï¼ˆcgo/MLXå‘¼ã³å‡ºã—å›æ•°å‰Šæ¸›ï¼‰
- â³ äºŒé‡é€ä¿¡ã®å†ªç­‰åŒ–ï¼ˆclient_cmd_idï¼‰

### ãƒãƒƒã‚¯ãƒ—ãƒ¬ãƒƒã‚·ãƒ£
- â³ ä¿å­˜ã‚­ãƒ¥ãƒ¼æº¢ã‚Œæ™‚ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ç‡èª¿æ•´
- â³ è¦ç´„ç²’åº¦ã®å‹•çš„èª¿æ•´

### ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•
- â³ MLXè½ã¡æ™‚ã®ãƒ¢ãƒ‡ãƒ«ç„¡ã—ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
- â³ æ—¢å­˜ãƒã‚¸ã‚·ãƒ§ãƒ³ç®¡ç†ã®ã¿ãƒ¢ãƒ¼ãƒ‰

### ãƒ­ã‚°/ç›£æŸ»
- â³ æ³¨æ–‡IDã§RESTâ†”WSæ•´åˆæ€§ç¢ºèª
- â³ å…¨æ±ºå®šã«ç†ç”±ï¼ˆç‰¹å¾´å€¤ãƒ»ç¢ºç‡ãƒ»EVï¼‰æ·»ä»˜

å‡¡ä¾‹: âœ…å®Œäº† / â³æœªå®Ÿè£… / ğŸš§ä½œæ¥­ä¸­

---

## ä½¿ç”¨äºˆå®šAIãƒ¢ãƒ‡ãƒ«

| ãƒ¢ãƒ‡ãƒ«ç¾¤ | éç·šå½¢è¡¨ç¾åŠ› | æ™‚ç³»åˆ—é †åºæ‰±ã„ | ãƒ‰ãƒªãƒ•ãƒˆå¯¾å¿œ | æ¨è«–é€Ÿåº¦ | ç‰¹å¾´ä¾å­˜ | å…¸å‹ãƒ¦ãƒ¼ã‚¹ |
|---------|-------------|---------------|-------------|----------|---------|-----------|
| SGD/FTRL/Passive-Aggressive | ä½ã€œä¸­ | æ˜ç¤ºçš„ãªã— | å¼·ã„ | æœ€è»½é‡ï¼ˆÎ¼sã€œmsï¼‰ | é«˜ã„ | ä½é…å»¶ãƒ»é€£ç¶šå­¦ç¿’ |
| LightGBM/HistGBDT | ä¸­ã€œé«˜ | æš—é»™çš„ | ä¸­ | è»½ã„ï¼ˆmså°ï¼‰ | ä¸­ | æ—¥æ¬¡å†å­¦ç¿’ãƒ»è§£é‡ˆæ€§ |
| TCN/1D-CNNï¼ˆTinyLOBç³»ï¼‰ | ä¸­ | ãƒã‚¤ãƒ†ã‚£ãƒ– | ä¸­ | è»½ã„ï¼ˆmsã€œæ•°msï¼‰ | ä½ã€œä¸­ | æ¿ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º |
| HMM/ã‚«ãƒ«ãƒãƒ³+ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯ | ä½ã€œä¸­ | ãƒ¬ã‚¸ãƒ¼ãƒ é–“æ¥ | å¼·ã„ | è»½ã„ï¼ˆÎ¼sã€œmsï¼‰ | ä¸­ | å¸‚æ³åˆ¥åˆ‡æ›¿ |

**æ³¨**: å®Ÿè£…å„ªå…ˆåº¦ã¯ SGD/FTRL â†’ LightGBM â†’ TCN ã®é †

---

## å‚è€ƒãƒªãƒ³ã‚¯

### Kraken WebSocket APIs
- [Global Intro](https://docs.kraken.com/api/docs/guides/global-intro)
- [Spot WebSocket](https://docs.kraken.com/api/docs/guides/spot-ws-intro)
- [Market Data](https://docs.kraken.com/api/docs/websocket-v2/ticker)

### Kraken REST APIs
- [Spot REST Intro](https://docs.kraken.com/api/docs/guides/spot-rest-intro)
- [Tradable Asset Pairs](https://docs.kraken.com/api/docs/rest-api/get-tradable-asset-pairs)

### Bitfinex WebSocket APIs
- [General](https://docs.bitfinex.com/docs/ws-general)
- [Public Channels](https://docs.bitfinex.com/docs/ws-public)
- [Ticker](https://docs.bitfinex.com/reference/ws-public-ticker)
- [Trades](https://docs.bitfinex.com/reference/ws-public-trades)
- [Books](https://docs.bitfinex.com/reference/ws-public-books)
- [Candles](https://docs.bitfinex.com/reference/ws-public-candles)
- [Status](https://docs.bitfinex.com/reference/ws-public-status)

### Bitfinex REST APIs
- [Platform Status](https://docs.bitfinex.com/reference/rest-public-platform-status)
- [Tickers](https://docs.bitfinex.com/reference/rest-public-tickers)
- [Trades](https://docs.bitfinex.com/reference/rest-public-trades)
- [Book](https://docs.bitfinex.com/reference/rest-public-book)
- [Candles](https://docs.bitfinex.com/reference/rest-public-candles)
- [Config](https://docs.bitfinex.com/reference/rest-public-conf)

### Apache Arrow
- [Go Package](https://pkg.go.dev/github.com/apache/arrow/go/arrow)
- [Format Intro](https://arrow.apache.org/docs/format/Intro.html)
- [Columnar Format](https://arrow.apache.org/docs/format/Columnar.html)

### Fyne Documentation
- [API v2.6](https://docs.fyne.io/api/v2.6/)
- [Widget](https://docs.fyne.io/api/v2.6/widget/)
- [Container](https://docs.fyne.io/api/v2.6/container/)
- [Data Binding](https://docs.fyne.io/api/v2.6/data/binding/)

---

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«æº–æ‹ 

## è¿½åŠ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [WebSocketè¨­å®šã‚·ã‚¹ãƒ†ãƒ è©³ç´°](docs/WEBSOCKET_CONFIG.md)
- [AIé–‹ç™ºæŒ‡é‡](CLAUDE.md)

---

**æœ€çµ‚æ›´æ–°**: 2025-09-30
